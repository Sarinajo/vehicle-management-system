{% extends 'main/base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
<form method="post">
    {% csrf_token %}

    <!-- Render 'date' field as readonly (no datepicker) -->
    <div class="mb-3">
        {{ form.date.label_tag }}
        {{ form.date }}
    </div>

    <!-- Render remaining fields normally -->
    {% for field in form %}
        {% if field.name != 'date' %}
            <div class="mb-3">
                {{ field.label_tag }}
                {{ field }}
            </div>
        {% endif %}
    {% endfor %}

    <button type="submit" class="btn btn-primary">Submit</button>
</form>

<!-- Bootstrap Select for driver -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/css/bootstrap-select.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>

<!-- Nepali Datepicker only for bill_date -->
<script src="https://nepalidatepicker.sajanmaharjan.com.np/v5/nepali.datepicker/js/nepali.datepicker.v5.0.6.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Nepali Datepicker only for bill_date
    var billInput = document.getElementById("bill-nepali");
    if (billInput) {
        billInput.NepaliDatePicker();
    }

    // Initialize searchable/typeable driver dropdown
    $('.selectpicker').selectpicker();
var maintenanceInput = document.getElementById("id_maintenance_cost");
    var reasonInput = document.getElementById("id_reason_for_maintenance");
    var reasonLabel = reasonInput.previousElementSibling;

    function toggleReasonRequirement() {
        if (parseFloat(maintenanceInput.value || 0) > 0) {
            reasonInput.required = true;
            reasonLabel.innerHTML = "Reason for Maintenance <span class='text-danger'>*</span>";
        } else {
            reasonInput.required = false;
            reasonLabel.innerHTML = "Reason for Maintenance";
        }
    }

    // Check on page load
    toggleReasonRequirement();

    // Update dynamically when maintenance cost changes
    maintenanceInput.addEventListener('input', toggleReasonRequirement);
});
</script>
{% endblock %}
